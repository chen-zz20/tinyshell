# tinyshell
## 1. 选题背景意义
命令行（Command Line 或 Command Prompt）是操作系统中通过文本指令与用户交互的一种工作环境。运行编写的程序的窗口被称为终端（Terminal），就是一个以图形窗口展现命令行的程序。在常见操作系统中，图形界面只是表象，其基础都是命令行操作。因此，常见操作系统即使在没有图形界面的环境下，也会提供一个命令行，通常被称为控制台（Console）。命令行的核心，是被称为壳（Shell）的命令行解释器。在不同的操作系统环境下，常用的命令行指令各不相同，但功能有相似性甚至对应关系。比如，在 Windows 环境下，常用的壳程序名为 cmd.exe，其中查看当前目录的指令为 dir；在 Linux 环境下，常用的壳程序名为 bash，其中查看当前目录的指令为ls。 

在本作业中，将尝试使用C++模拟命令行，可以在其中执行一些指定的指令，如比较两个文件内容、查找文件内容等。

## 2. 同类软件调研分析
本次大作业希望能够完成一个模拟命令行TinyShell，即能够提供一个shell的命令行解释器，能够解释在命令行中输入的指令并做出相应的响应。

目前同类型的软件有很多，因为命令行是任何一个操作系统的根基，所以市面上的任何一个操作系统都提供一个命令行作为与用户交互的界面。比如windows系统的cmd、PowerShell；Linux系统的bash；MacOS系统的Terminal应用，均为同类产品。而除了这些主流的操作系统自带的命令行之外，还有很多各具特色的命令行，比如能够在windows系统下运行git指令的gib bash命令行、用来远程连接服务器的Xshell命令行，或者扩大范围而言，很多解释型语言会提供交互式的运行方式，也可以算作命令行的一种，比如python语言以及matlab语言，均可在交互模式下运行，也就是输入一个指令，解释器在调用之后经过分析会自动返回运行结果。这些都可以算作命令行的一种。

由上述对同类软件的分析我们知道，对于计算机来说，操作系统以及软件解释器等与用户交互的最基础最底层的方式就是命令行，它们各具特色，各有各的特点，也各有各的不同。对于和系统相关的命令行，它们各种的特色是和自己的操作系统联系在一起的，二者不能简单割裂。但是就命令行本身而言，Xshell和bash都实现了日志功能，可以很简单的通过查找日志log来定位代码错误在哪里，是一个独有的优势；bash还会在输入时候自动判断调用的命令和命令参数的区别并将其染色，使得用户可以用更鲜明的区分输入指令与指令参数的区别，方便用户使用；bash命令行中对输入指令但指令参数有误的情况下提示也更加全面可靠；而cmd命令行在输入文件名时候用Tab键自动补全，会在前缀确定的情况下自动在各个有相同前缀的文件下面跳转，bash命令行则自动补全到两个有相同前缀文件名的不同之处，需要用户手动填写下一个字母才能继续自动补全。相比之下cmd命令行的自动补全方案更加人性化。总而言之，目前各种成熟的命令行系统在与用户交互时候各有方便之处，各有各的特点与不足。

本次大作业准备实现的命令行，仅仅能够做到执行一部分指令。与要主要模仿的linux的命令行而言，主要创新点在于用C++语言重写，引入了C++的一些新特性，代码灵活，可扩展性强。命令行是计算机操作系统的基础，通过编写本程序有助于作者以及别人在阅读代码的时候对操作系统的交互功能有初步了解。

## 3. 详细的功能设计
在本次大作业中，预计将实现以下功能：
### cat指令
用于连接文件并输出到标准输出上，可以在不打开图形文本编辑器的情况下预览文件。

选项说明：

--help：显示帮助。 

-n：由 1 开始对所有输出的行数编号。

-b：和-n 相似，只不过对于空白行不编号，但需要输出空白行。

-s：当遇到有连续两行以上的空白行，就代换为一行的空白行。

-E：在每行结束处显示$。

[功能参考](https://www.man7.org/linux/man-pages/man1/cat.1.html)

### tee指令
从标准输入读取数据，将其内容输出到标准输出，同时可以保存至多个文件。tee 单独使用时，不由键盘输入写入文件的内容，而由标准输入 strin 读取，即仅创建空文件。

--help：显示帮助。

-a：附加到既有文件的后面，而非覆盖它。

[功能参考](https://www.man7.org/linux/man-pages/man1/tee.1.html)

### cp指令
用于复制文件。

选项说明：

--help：显示帮助。

-n：不覆盖已存在的文件。

[功能参考](https://www.man7.org/linux/man-pages/man1/cp.1.html)

### pwd指令
用于显示工作目录。

选项说明：

--help：显示帮助。

[功能参考](https://www.man7.org/linux/man-pages/man1/pwd.1.html)

### echo指令
用于字符串的输出。依次输出{字符串}到标准输出。简单起见，不识别{字符串}中的转义字符。

选项说明：

--help：显示帮助。 

-n：表示输出之后不换行。

[功能参考](https://www.man7.org/linux/man-pages/man1/echo.1.html)

### diff指令
逐行比较[文件 1]和[文件 2]的内容。

选项说明：

--help：显示帮助。

-b：不检查空格字符的不同。

-B：不检查空白行。

-i：不检查大小写的不同。

-q：仅显示有无差异，不显示详细的信息。无差异时不显示，有差异时显示"File [文件 1] and [文件 2] differ"。 

-w：忽略全部的空格字符。

-I [字符串]：若两个文件在某几行有所不同，但这几行同时都包含了选项中指定字符串，则不显示这两个文件的差异。

### grep指令

用于查找文件里符合条件的字符串，并把含有该字符串的那一行显示出来，符合条件的字符串以加粗亮红色显示。

匹配规则：在每个[文件]中逐行寻找包含符合[模式串]的行。[模式串]可以是普通字符串，也可以包含通配符（.或*）。“.”可匹配一个任意字符；“*”可匹配任意数量（包括 0）任意字符。匹配时，将使得匹配到的字符串尽量长。例如：ab.c 与 abdc 匹配；ab*c 与 abc、abdc、abedc 均匹配；在尝试将 ab*c 与 cabcdefcd 匹配时，将匹配其中的 abcdefc。

选项说明：

--help：显示帮助

-c：计算符合样式的行数。

-h：在显示符合样式的那一行之前，不标示该行所属的文件名称。

-H：在显示符合样式的那一行之前，标示该行所属的文件名称。

-i：忽略字符大小写的差别。

-n：在显示符合样式的那一行之前，标示出该行的编号。

-A[行数]：除了显示符合范本样式的那一列之外，同时显示该行之后的[行数]行内容。多行连续匹配需要合并输出，不要冗余输出。

-B[行数]：除了显示符合样式的那一行之外，同时显示该行之前的[行数]内容。多行连续匹配需要合并输出，不要冗余输出。

(功能参考)[https://www.man7.org/linux/man-pages/man1/grep.1.html]

### 复合指令
使用"|"运算符连接两个指令。可嵌套。多指令的衔接可以形成非常灵活的效果。